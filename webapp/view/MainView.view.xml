<mvc:View
    controllerName="rapportavisqualite.controller.ViewAvis"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core">

    <Page id="mainPage" title="Rapport des Avis">
        <content>
            
            <!-- DASHBOARD EN HAUT -->
    <VBox id="_IDGenVBox1" class="sapUiMediumMargin sapUiResponsiveMargin">
        <ObjectNumber id="_IDGenObjectNumber3" number="{/stats/erreurs}" unit="Erreurs" />

        <!-- Statistiques clés -->
        <HBox id="_IDGenHBox2" justifyContent="SpaceAround" class="sapUiSmallMarginBottom">
            <ObjectNumber id="_IDGenObjectNumber2" number="{/stats/erreurs}" unit="Erreurs" state="Error" />
            <ObjectNumber id="_IDGenObjectNumber1" number="{/stats/warnings}" unit="Avertissements" state="Warning" />
            <ObjectNumber id="_IDGenObjectNumber" number="{/stats/success}" unit="Corrects" state="Success" />
        </HBox>

        <!-- Taux de succès -->
        <VBox id="_IDGenVBox2" class="sapUiSmallMarginBottom">
            <Text id="idfg" text="Taux de réussite global" />
            <ProgressIndicator id="_IDGenProgressIndicator" percentValue="{/stats/tauxSucces}" displayValue="{/stats/tauxSucces}%" state="Success" />
        </VBox>

        <!-- Graphique -->
        <viz:VizFrame id="chart" xmlns:viz="sap.viz.ui5.controls"
                      width="100%" height="400px" vizType="column">
            <viz:dataset>
                <viz.data:FlattenedDataset id="_IDGenFlattenedDataset" xmlns:viz.data="sap.viz.ui5.data"
                                           data="{/chartData}">
                    <viz.data:dimensions>
                        <viz.data:DimensionDefinition id="_IDGenDimensionDefinition" name="Catégorie" value="{categorie}" />
                    </viz.data:dimensions>
                    <viz.data:measures>
                        <viz.data:MeasureDefinition id="_IDGenMeasureDefinition" name="Valeur" value="{valeur}" />
                    </viz.data:measures>
                </viz.data:FlattenedDataset>
            </viz:dataset>
            <viz:feeds>
                <viz.feeds:FeedItem id="_IDGenFeedItem" xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds" uid="valueAxis" type="Measure" values="Valeur" />
                <viz.feeds:FeedItem id="_IDGenFeedItem1" xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds" uid="categoryAxis" type="Dimension" values="Catégorie" />
            </viz:feeds>
        </viz:VizFrame>
    </VBox>
            <!-- Barre d'options -->
            <HBox id="_IDGenHBox" class="sapUiSmallMargin sapUiMediumMarginBottom" justifyContent="Start">
                <Button id="_IDGenButton" text="Général" press="onShowGeneral" />
                <Button id="_IDGenButton1" text="Délai" press="onShowDelai" class="sapUiSmallMarginBeginEnd" />
                <Button id="_IDGenButton2" text="Vérification" press="onShowVerification" />
            </HBox>

            <!-- Barre de filtres personnalisée -->
            <VBox id="filterBox" class="sapUiSmallMargin">
                <HBox id="_IDGenHBox1">
                    <Label id="_IDGenLabel" text="Numéro d'avis" class="sapUiSmallMarginEnd" />
                    <Input id="numeroAvisInput" width="200px" placeholder="Rechercher..."/>

                    <Label id="_IDGenLabel1" text="Type d'avis" class="sapUiSmallMarginEnd sapUiSmallMarginBegin"/>
                    <Input id="typeAvisInput" width="200px" placeholder="Rechercher..."/>

                    <Label id="_IDGenLabel2" text="Statut de l'avis" class="sapUiSmallMarginEnd sapUiSmallMarginBegin"/>
                    <Input id="statutAvisInput" width="200px" placeholder="Rechercher..."/>

                    <Button id="_IDGenButton3" text="Filtrer" press="onFilter" class="sapUiSmallMarginBegin"/>
                </HBox>
            </VBox>

            <!-- Tableau principal : Général -->
            <Table id="avisTable" items="{localAvis>/avis}" inset="false" visible="true">
                <columns>
                    <Column id="_IDGenColumn"><Text id="ezerze" text="Numéro d'avis" /></Column>
                    <Column id="_IDGenColumn1"><Text id="ezree" text="Type d'avis" /></Column>
                    <Column id="_IDGenColumn2"><Text id="eerzeze" text="Statut de l'avis" /></Column>
                    <Column id="_IDGenColumn3"><Text id="eerze" text="Date de l'avis" /></Column>
                    <Column id="_IDGenColumn4"><Text id="rezeze" text="Créé par" /></Column>
                    <Column id="_IDGenColumn5"><Text id="efsdfze" text="Article" /></Column>
                    <Column id="_IDGenColumn6"><Text id="ezere" text="Description d'article" /></Column>
                    <Column id="_IDGenColumn7"><Text id="ezsfe" text="Âge du dossier" /></Column>
                    <Column id="_IDGenColumn8"><Text id="esdfsfze" text="" /></Column> <!-- Colonne pour l'icône d'infos -->
                </columns>
                <items>
                    <ColumnListItem id="_IDGenColumnListItem">
                        <cells>
                            <Text id="ezsze" text="{localAvis>numero}" />
                            <Text id="eztrye" text="{localAvis>type}" />
                            <Text id="ezyje" text="{localAvis>statut}" />
                            <Text id="ezvcxce" text="{localAvis>date}" />
                            <Text id="ezsdse" text="{localAvis>creePar}" />
                            <Text id="ezetyt" text="{localAvis>article}" />
                            <Text id="ezuyuie" text="{localAvis>description}" />
                            <Text id="ehjze" text="{localAvis>age}" />
                            <Button id="_IDGenButton4" icon="sap-icon://hint" press="onShowFullVerificationReport" tooltip="Plus d'infos"/>
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>

            <!-- Deuxième tableau : Délai -->
            <Table id="delaiTable" items="{localAvis>/avis}" visible="false">
                <columns>
                    <Column id="_IDGenColumn9"><Text id="eazaze" text="Numéro d'avis" /></Column>
                    <Column id="_IDGenColumn10"><Text id="eesze" text="Temps de cycle des dispositions" /></Column>
                    <Column id="_IDGenColumn11"><Text id="eazze" text="Feu de circulation" /></Column>
                    <Column id="_IDGenColumn12"><Text id="ehgfze" text="Délai AQ" /></Column>
                    <Column id="_IDGenColumn13"><Text id="eereze" text="Délai AQ Feu de circulation" /></Column>
                    <Column id="_IDGenColumn14"><Text id="ezeazze" text="Délai Service Détecteur" /></Column>
                    <Column id="_IDGenColumn15"><Text id="eqsze" text="Délai Service Détecteur Feu de circulation" /></Column>
                </columns>
                <items>
                    <ColumnListItem id="_IDGenColumnListItem1">
                        <cells>
                            <Text id="eyujyze" text="{localAvis>numero}" />
                            <Text id="esdze" text="{localAvis>tempsCycle}" />
                            <Text id="ezxwwxe" text="{localAvis>feu}" />
                            <Text id="esqsqsze" text="{localAvis>delaiAQ}" />
                            <Text id="esqdze" text="{localAvis>delaiAQFeu}" />
                            <Text id="esqsze" text="{localAvis>delaiDetecteur}" />
                            <Text id="eqze" text="{localAvis>delaiDetecteurFeu}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
            <Dialog id="verifDialog" title="Rapport de vérification" draggable="true" resizable="true">
            <VBox id="_IDGenVBox" class="sapUiSmallMargin">
                <Text id="verifRapportText" text="Chargement..." />
            </VBox>
            <endButton>
                <Button id="_IDGenButton5" text="Fermer" press="onCloseVerifDialog"/>
            </endButton>
        </Dialog>

        </content>
    </Page>
</mvc:View>
