<mvc:View
    controllerName="rapportavisqualite.controller.ViewAvis"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:html="http://www.w3.org/1999/xhtml">

    <Page id="mainPage" title="Rapport des Avis">
        <content>

            <!-- Barre des segments -->
            <VBox id="_IDGenVBox" class="sapUiSmallMargin">
                <HBox id="_IDGenHBox">
                    <Label id="_IDGenLabel" text="Afficher par groupe :" class="sapUiSmallMarginEnd"/>
                    <SegmentedButton id="segmentGroups" selectionChange="onSegmentChange">
                        <items>
                            <SegmentedButtonItem id="_IDGenSegmentedButtonItem" text="Général" key="general" />
                            <SegmentedButtonItem id="_IDGenSegmentedButtonItem1" text="Délais" key="delais" />
                            <SegmentedButtonItem id="_IDGenSegmentedButtonItem2" text="Vérifications" key="verifications" />
                        </items>
                    </SegmentedButton>
                </HBox>
            </VBox>

            <!-- Tableau de données -->
            <Table id="avisTable" items="{localAvis>/avis}" inset="false">
                <columns>
                    <Column id="colNumero"><Text id="ida" text="Numéro d'avis" /></Column>
                    <Column id="colType"><Text id="idb" text="Type d'avis" /></Column>
                    <Column id="colStatut"><Text id="idc" text="Statut de l'avis" /></Column>
                    <Column id="colDate"><Text id="idd" text="Date de l'avis" /></Column>

                    <!-- Groupe Délais -->
                    <Column id="colDelaiAQ"><Text id="idgd" text="Délai AQ" /></Column>
                    <Column id="colDelaiService"><Text id="ide" text="Délai Service Détecteur" /></Column>

                    <!-- Groupe Vérification -->
                    <Column id="colVerifReception"><Text id="idf" text="Vérif. Date réception info." /></Column>

                    <!-- Colonne bouton Détails -->
                    <Column id="colDetails" hAlign="Center"><Text id="idg" text="Détails" /></Column>
                </columns>
                <items>
                    <ColumnListItem id="_IDGenColumnListItem">
                        <cells>
                            <Text id="idaa" text="{localAvis>numero}" />
                            <Text id="idab" text="{localAvis>type}" />
                            <Text id="idbga" text="{localAvis>statut}" />
                            <Text id="idamp" text="{localAvis>date}" />

                            <Text id="idaol" text="{localAvis>delaiAQ}" />
                            <Text id="idpa" text="{localAvis>delaiService}" />

                            <Text id="idma" text="{localAvis>verifReception}" />

                            <Button id="_IDGenButton" icon="sap-icon://inspection" press="onShowDetails" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>

            <!-- Popover pour détails -->
            <Popover id="detailsPopover" placement="Auto" showHeader="false">
                <VBox id="_IDGenVBox1" class="sapUiSmallMargin">
                    <Text id="idpma" text="🗂️ Détails de l'avis" class="sapUiSmallMarginBottom sapUiTinyMarginTop"/>
                    <Text id="detailsText" />
                </VBox>
            </Popover>

        </content>
    </Page>
</mvc:View>
